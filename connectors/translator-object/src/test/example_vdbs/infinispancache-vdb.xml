<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<vdb name="team" version="1">

    <description>Shows how to call Web Services</description>
    
    <property name="UseConnectorMetadata" value="cached" />
<!-- connection-jndi-name="dummy" -->
    <model name="Team" visible="false">
        <source name="objsource" translator-name="infinispan1" />
        <metadata type="DDL"><![CDATA[
            CREATE FOREIGN TABLE Team (TeamObject Object);
         ]]> </metadata>
    </model>
    <model name="TeamView" type="VIRTUAL">
         <metadata type="DDL"><![CDATA[
             CREATE VIEW Teams (
                 TeamName varchar(255) PRIMARY KEY
             )
             AS
               SELECT o.TeamName FROM Team as T, OBJECTTABLE('x' PASSING T.TeamObject AS x COLUMNS TeamName varchar(255) 'teiid_row.name') as o;
             CREATE VIEW Players (
                  TeamName varchar(255) PRIMARY KEY,
                  PlayerName varchar(255)
             )
             AS
             SELECT o.TeamName, y.Name FROM Team as T, OBJECTTABLE('x' PASSING T.TeamObject AS x COLUMNS TeamName varchar(255) 'teiid_row.name', players object 'teiid_row.players') as o, OBJECTTABLE('m' PASSING o.players as m COLUMNS Name string 'teiid_row') as y;          
        ]]> </metadata>
    </model>

    <translator name="infinispan1" type="infinispan-cache">
        <property name="CacheName" value="teams"/>
        <property name="RootClassName" value="com.jboss.datagrid.hotrod.Team"/>
        <property name="CacheJndiName" value="java/CacheManager"/>
        <property name="SupportsLuceneSearching" value="true"/>
        
        <!--  optional properties for obtaining the RemoteCacheManager  -->
        <!--
         <property name="ConfigurationFileName" value="<dir>/infinispan-config.xml"/>
         -->

    </translator>
</vdb>